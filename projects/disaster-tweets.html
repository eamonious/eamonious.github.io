<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Identifying Critical Tweets During Disasters</title>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="author" content="" />

  <!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="favicon.ico">

	<link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">



	<!-- Animate.css -->
	<link rel="stylesheet" href="../css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../css/bootstrap.css">
	<!-- Flexslider  -->
	<link rel="stylesheet" href="../css/flexslider.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="../css/style.css">
	<!--Project Page Style -->
	<link rel="stylesheet" href="../css/project-page.css">

	<!-- Modernizr JS -->
	<script src="../js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	<!-- Loading mathjax macro -->
	<!-- Load mathjax -->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
			<!-- MathJax configuration -->
			<script type="text/x-mathjax-config">
			MathJax.Hub.Config({
					tex2jax: {
							inlineMath: [ ['$','$'], ["\\(","\\)"] ],
							displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
							processEscapes: true,
							processEnvironments: true
					},
					// Center justify equations in code and markdown cells. Elsewhere
					// we use CSS to left justify single line equations in code cells.
					displayAlign: 'center',
					"HTML-CSS": {
							styles: {'.MathJax_Display': {"margin": 0}},
							linebreaks: { automatic: true }
					}
			});
			</script>
			<!-- End of mathjax configuration -->

	</head>
	<body>

		<div id="colorlib-page">
			<a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle"><i></i></a>

			<aside id="colorlib-aside" role="complementary" class="border js-fullheight">
				<div id="colorlib-logo">
					<a href="../index.html"><span><img src="../images/e-icon.png" width="90px"></span></a></div>

				<nav id="colorlib-main-menu" role="navigation">
					<ul>
						<li><a href="../index.html">Home</a></li>
						<li><a href="../work.html">Projects</a></li>
						<li><a href="../about.html">Eamon</a></li>
						<li><a href="../skills.html">Skills</a></li>
						<li><a href="../blog.html">Blog</a></li>
						<li class="colorlib-active"><a href="../contact.html">Contact</a></li>
					</ul>
				</nav>

				<div class="colorlib-footer">
					<p><small></small></p>
					<ul>
						<li><a href="mailto:eamonfleming@gmail.com"><i class="icon-mail5"></i></a></li>
						<li><a href="https://www.linkedin.com/in/eamonfleming"><i class="icon-linkedin2"></i></a></li><br/>
						<li><a class="img-icon-aside" href="https://profiles.generalassemb.ly/eamon-fleming" style="background: url('../images/ga-icon-close.png');
																																																				background-size: contain;
																																																				background-repeat: no-repeat;
																																																				background-position: center center;")><img id="ga-aside" width="29px" src="../images/ga-icon-close-blackwhite.png"></a></li>
						<li><a href="https://github.com/eamonious/"><i class="icon-github"></i></a></li>
						<!--<li><a href="#"><i class="icon-facebook2"></i></a></li>-->
						<!--<li><a href="#"><i class="icon-twitter2"></i></a></li>-->
						<!--<li><a href="https://www.instagram.com/eamonious/"><i class="icon-instagram"></i></a></li>-->
					</ul>
				</div>

			</aside>

			<div id="colorlib-main">

	<div class="colorlib-project">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-12">
					<h2 class="colorlib-heading animate-box" data-animate-effect="fadeInLeft">Out of the Sea</h2>
					<span class="heading-meta">Identifying Critical Tweets During Disasters</span>
				</div>
			</div>

<div class="row">
	<div class="col-md-5">
<!--PROJECT NOTEBOOK TOP -->


<div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Contents:">Contents:<a class="anchor-link" href="#Contents:">&#182;</a></h3><hr>
<ul class="contents">
<li><a href="#Problem-Statement">Problem Statement</a></li>
<li><a href="#Importing-Libraries">Importing Libraries</a></li>
<li><a href="#Data-Collection">Data Collection</a></li>
<li><a href="#Pulling-Tweets-with-Twython">Pulling Tweets with Twython</a></li>
<li><a href="#Filtering-for-Disaster-Tweets:-Figure-Eight-Model">Filtering for Disaster Tweets: Figure Eight Model</a></li>
<li><a href="#Filtering-for-Disaster-Tweets:-Crisis-Words">Filtering for Disaster Tweets: Crisis Words</a></li>
<li><a href="#Apply-Filters-to-Generate-List-of-Disaster-Tweets">Apply Filters to Generate List of Disaster Tweets</a></li>
<li><a href="#Identifying-Critical-Tweets-Among-Disaster-Tweets">Identifying Critical Tweets Among Disaster Tweets</a></li>
<li><a href="#Testing-2-Phase-Model-{1.-Disaster-Filter,-2.-Predict-Critical}-on-New-Data">Testing 2-Phase Model (1. Disaster Filter, 2. Predict Critical) on New Data</a></li>
<li><a href="#Create-Combined-Landfall-Dataset-with-Class-Labeling">Create Combined Landfall Dataset with Class Labeling</a></li>
<li><a href="#Geomapping-Landfall-Data-in-Tableau">Geomapping Landfall Data in Tableau</a></li>
<li><a href="#Live-Streaming-Disaster-Tweets-via-Twython">Live Streaming Disaster Tweets via Twython</a></li>
<li><a href="#Conclusions">Conclusions:</a></li>
</ul>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Problem-Statement">Problem Statement<a class="anchor-link" href="#Problem-Statement">&#182;</a></h1><p>In this project we sought to make initial steps toward designing and implementing a web-tool or an app for rapid alert and notification about a disastrous event, in close to real time. The tool ideally would alert about the event, similar, for example, to earthquake or tsunami warnings that appear on Google's home page immediately after a major disaster. While traditional methods for alerting on such events rely on official information derived from official sources (e.g. USGS), this tool will utilize social media activity to identify these events and alert when an event first occurs.</p>
<p>The question we look at primarily here is, given a sea of text content from social media platforms, how do you identify what is relevant information for emergency response personnel?  And what sort of implementation would be valuable?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Importing-Libraries">Importing Libraries<a class="anchor-link" href="#Importing-Libraries">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[556]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">twython</span> <span class="k">import</span> <span class="n">Twython</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">CountVectorizer</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">,</span> <span class="n">HashingVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="k">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="k">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span><span class="p">,</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="k">import</span> <span class="n">WordCloud</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[557]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-Collection">Data Collection<a class="anchor-link" href="#Data-Collection">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our initial plan was to try and real-time map incoming tweets using Twitter, Facebook, Instagram, Snapchat, etc.  We quickly found that the APIs for these social media platforms have become much more restrictive than they used to be.  The limits on how many tweets we could get at one time were such that it wasn't feasible to build out a dataset that would support training a model.  We also could not get geolocation.  We needed a different approach.</p>
<p>We found a useful dataset on the website CrisisLex, which collects datasets specific to NLP applications in disaster scenarios. This dataset contained tweet IDs for all geotagged tweets (6 million +) from affected areas of the Eastern Seaboard during the 11 day period surrounding Hurricane Sandy's landfall (10/22/2012-11/2/2012).  The tweets include all content, not just disaster-related tweets.</p>
<p>You can use specific tweet IDs to pull dictionaries corresponding to the specific tweets.  Having specific tweet IDs also allows you to collect up to 900 tweets every fifteen minutes, which is much larger than the normal limit.  The fact that geotags with precise coordinates of sending location and timestamps to the second are included in the data is also very relevant, as it allows live-mapping, and accurately simulates the kind of information we would expect FEMA to have access to in this type of real-world application scenario.</p>
<p>Hurricanes, of all disasters, are probably the best-equipped to represent a generalizable lexicon, as hurricanes often involve a combination of flooding, fires, building damage/collapse, sufficient wind to down trees, explosions, injuries, deaths, trapped/stranded individuals, etc.  Obviously, the training data could be expanded to include a variety of disaster types in the future.</p>
<p>Further Information on the CrisisLex Sandy Tweet ID Dataset:</p>
<ul>
<li><a href="https://crisislex.org/data-collections.html#SandyHurricaneGeoT1">CrisisLex: SandyHurricaneGeoT1 Geo-Located tweets from the 2012 Sandy Hurricane</a></li>
<li>Contents: tweet ids for 6,556,328 tweets, representing all tweets from October 22nd, 2012 —the day Sandy formed— until November 2nd, 2012 — the day that it dissipated.</li>
<li>Sampling method: tweets were geotagged and located in Washington DC or one of 13 US states affected by Sandy: Connecticut, Delaware, Massachusetts, Maryland, New Jersey, New York, North Carolina, Ohio, Pennsylvania, Rhode Island, South Carolina, Virginia,West Virginia. This filter was based on a set of bounding boxes that covered the desired area, which also covered small parts of adjacent states.</li>
<li>Labels: no labels. The corpus contains tweets both relevant and irrelevant to Hurricane Sandy (no content based filter was applied).</li>
<li>Data format: comma-separated values (.csv) files containing the tweet ID, the time stamp of the tweet, a field indicating whether the tweet contains word "sandy".</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cleaning-Sandy-ID-List">Cleaning Sandy ID List<a class="anchor-link" href="#Cleaning-Sandy-ID-List">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[562]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Imports the list of 6 Million IDs</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../release.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[667]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[667]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>tag:search.twitter.com,2005:260244087901413376...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>tag:search.twitter.com,2005:260244088203403264...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>tag:search.twitter.com,2005:260244088161439744...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>tag:search.twitter.com,2005:260244088819945472...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>tag:search.twitter.com,2005:260244089080004609...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[564]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[564]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(6554744, 1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[668]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Split data into respective columns, create datetime column, drop unnecessary columns</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span><span class="s1">&#39;bool&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[576]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[576]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tweet_id</th>
      <th>datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>260244087901413376</td>
      <td>2012-10-22 05:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>260244088203403264</td>
      <td>2012-10-22 05:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>260244088161439744</td>
      <td>2012-10-22 05:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>260244088819945472</td>
      <td>2012-10-22 05:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>260244089080004609</td>
      <td>2012-10-22 05:00:00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Building-ID-List-for-Sandy-Training-Set">Building ID List for Sandy Training Set<a class="anchor-link" href="#Building-ID-List-for-Sandy-Training-Set">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We wanted to simulate the sort of access to Twitter that FEMA would have during a crisis situation, i.e.; all geotagged and timestamped tweets within some period of time.  Moreover, we anticipated that our classes in our final model would be unbalanced, because actually critical disaster tweets would be quite rare.  We wanted to sample from the period that would have as many of these as possible, in order to have more of them to train on and rely less on bootstrapping.</p>
<p>Accordingly, we chose to sample from the window surrounding the landfall of Hurricane Sandy in New Jersey and New York (~8PM ET, October 29th, 2012.  We calculated that we could reasonably aim to pull about 180000 tweets for the training set, timewise.  We chose to pull all tweets from the list for the 3 hour period spanning from 1 hour prior to landfall to 2 hours afterward, so approximately 7PM-10PM that night.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[325]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dftime</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span>
<span class="n">dftime</span> <span class="o">=</span> <span class="n">dftime</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Picked the time index corresponding approximately to landfall of the hurricane </span>
<span class="n">dftime</span><span class="p">[</span><span class="n">dftime</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;2012-10-30 00:00:01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1">#creates our major id list, from approximate time of landfall in NJ to about 3 hours later </span>
<span class="c1">#(i.e., 180000 tweets down the timestamp-sorted ID list), all geotagged tweets in that time</span>
<span class="c1">#continuous timespan also allows us to show complete minute to minute mapping visualization</span>
<span class="n">sandy_id_time</span> <span class="o">=</span> <span class="n">dftime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4428365</span><span class="p">:</span><span class="mi">4608434</span><span class="p">,:]</span>
<span class="n">sandy_id_time</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;sandy_train_ids.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Pulling-Tweets-with-Twython">Pulling Tweets with Twython<a class="anchor-link" href="#Pulling-Tweets-with-Twython">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each of us created Twitter Development accounts and submitted applications for the project.  We each created two sets of <a href="https://developer.twitter.com/en/apply-for-access">Twitter API</a> app keys so that we could pull tweets in tandem to allow for higher volume data collection.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CONSUMER_KEY</span> <span class="o">=</span> <span class="s1">&#39;INSERT KEY HERE&#39;</span>
<span class="n">CONSUMER_SECRET</span> <span class="o">=</span> <span class="s1">&#39;INSERT KEY HERE&#39;</span>

<span class="n">OAUTH_TOKEN</span> <span class="o">=</span> <span class="s1">&#39;INSERT KEY HERE&#39;</span>
<span class="n">OAUTH_SECRET</span> <span class="o">=</span> <span class="s1">&#39;INSERT KEY HERE&#39;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">twitter</span> <span class="o">=</span> <span class="n">Twython</span><span class="p">(</span><span class="n">CONSUMER_KEY</span><span class="p">,</span> <span class="n">CONSUMER_SECRET</span><span class="p">,</span> <span class="n">OAUTH_TOKEN</span><span class="p">,</span> <span class="n">OAUTH_SECRET</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pulling-a-Single-Tweet">Pulling a Single Tweet<a class="anchor-link" href="#Pulling-a-Single-Tweet">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_train_ids</span><span class="p">[</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>260244088161439744</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">twitter</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;260244088161439744&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;created_at&#39;: &#39;Mon Oct 22 05:00:00 +0000 2012&#39;,
 &#39;id&#39;: 260244088161439744,
 &#39;id_str&#39;: &#39;260244088161439744&#39;,
 &#39;text&#39;: &#39;@NOT_savinHOES Not r yu upp&#39;,
 &#39;truncated&#39;: False,
 &#39;entities&#39;: {&#39;hashtags&#39;: [],
  &#39;symbols&#39;: [],
  &#39;user_mentions&#39;: [{&#39;screen_name&#39;: &#39;NOT_savinHOES&#39;,
    &#39;name&#39;: &#39;01.18🤸🏽\u200d♀️&#39;,
    &#39;id&#39;: 293455555,
    &#39;id_str&#39;: &#39;293455555&#39;,
    &#39;indices&#39;: [0, 14]}],
  &#39;urls&#39;: []},
 &#39;source&#39;: &#39;&lt;a href=&#34;http://twitter.com/download/android&#34; rel=&#34;nofollow&#34;&gt;Twitter for Android&lt;/a&gt;&#39;,
 &#39;in_reply_to_status_id&#39;: None,
 &#39;in_reply_to_status_id_str&#39;: None,
 &#39;in_reply_to_user_id&#39;: 293455555,
 &#39;in_reply_to_user_id_str&#39;: &#39;293455555&#39;,
 &#39;in_reply_to_screen_name&#39;: &#39;NOT_savinHOES&#39;,
 &#39;user&#39;: {&#39;id&#39;: 401231570,
  &#39;id_str&#39;: &#39;401231570&#39;,
  &#39;name&#39;: &#39;Jay 🤷🏽\u200d♂️&#39;,
  &#39;screen_name&#39;: &#39;JayyLive202&#39;,
  &#39;location&#39;: &#39;Washington, DC, USA&#39;,
  &#39;description&#39;: &#39;кιиg ʝαмєѕ🎩🏆 25. D[M]V | 👻:OfficialJaymes 📸Insta:Oh.ThatsAlexx&#39;,
  &#39;url&#39;: &#39;https://t.co/a6Q76c6YNl&#39;,
  &#39;entities&#39;: {&#39;url&#39;: {&#39;urls&#39;: [{&#39;url&#39;: &#39;https://t.co/a6Q76c6YNl&#39;,
      &#39;expanded_url&#39;: &#39;https://link.dosh.cash/JAMESR117&#39;,
      &#39;display_url&#39;: &#39;link.dosh.cash/JAMESR117&#39;,
      &#39;indices&#39;: [0, 23]}]},
   &#39;description&#39;: {&#39;urls&#39;: []}},
  &#39;protected&#39;: False,
  &#39;followers_count&#39;: 803,
  &#39;friends_count&#39;: 576,
  &#39;listed_count&#39;: 0,
  &#39;created_at&#39;: &#39;Sun Oct 30 07:41:09 +0000 2011&#39;,
  &#39;favourites_count&#39;: 326,
  &#39;utc_offset&#39;: None,
  &#39;time_zone&#39;: None,
  &#39;geo_enabled&#39;: True,
  &#39;verified&#39;: False,
  &#39;statuses_count&#39;: 18359,
  &#39;lang&#39;: &#39;en&#39;,
  &#39;contributors_enabled&#39;: False,
  &#39;is_translator&#39;: False,
  &#39;is_translation_enabled&#39;: False,
  &#39;profile_background_color&#39;: &#39;C0DEED&#39;,
  &#39;profile_background_image_url&#39;: &#39;http://abs.twimg.com/images/themes/theme1/bg.png&#39;,
  &#39;profile_background_image_url_https&#39;: &#39;https://abs.twimg.com/images/themes/theme1/bg.png&#39;,
  &#39;profile_background_tile&#39;: True,
  &#39;profile_image_url&#39;: &#39;http://pbs.twimg.com/profile_images/1070198512380461056/zthonwAC_normal.jpg&#39;,
  &#39;profile_image_url_https&#39;: &#39;https://pbs.twimg.com/profile_images/1070198512380461056/zthonwAC_normal.jpg&#39;,
  &#39;profile_banner_url&#39;: &#39;https://pbs.twimg.com/profile_banners/401231570/1543990185&#39;,
  &#39;profile_link_color&#39;: &#39;0084B4&#39;,
  &#39;profile_sidebar_border_color&#39;: &#39;FFFFFF&#39;,
  &#39;profile_sidebar_fill_color&#39;: &#39;DDEEF6&#39;,
  &#39;profile_text_color&#39;: &#39;333333&#39;,
  &#39;profile_use_background_image&#39;: True,
  &#39;has_extended_profile&#39;: True,
  &#39;default_profile&#39;: False,
  &#39;default_profile_image&#39;: False,
  &#39;following&#39;: False,
  &#39;follow_request_sent&#39;: False,
  &#39;notifications&#39;: False,
  &#39;translator_type&#39;: &#39;none&#39;},
 &#39;geo&#39;: {&#39;type&#39;: &#39;Point&#39;, &#39;coordinates&#39;: [40.2371544, -76.8206691]},
 &#39;coordinates&#39;: {&#39;type&#39;: &#39;Point&#39;, &#39;coordinates&#39;: [-76.8206691, 40.2371544]},
 &#39;place&#39;: {&#39;id&#39;: &#39;b8ce2948ffafff5f&#39;,
  &#39;url&#39;: &#39;https://api.twitter.com/1.1/geo/id/b8ce2948ffafff5f.json&#39;,
  &#39;place_type&#39;: &#39;city&#39;,
  &#39;name&#39;: &#39;Bressler-Enhaut-Oberlin&#39;,
  &#39;full_name&#39;: &#39;Bressler-Enhaut-Oberlin, PA&#39;,
  &#39;country_code&#39;: &#39;US&#39;,
  &#39;country&#39;: &#39;United States&#39;,
  &#39;contained_within&#39;: [],
  &#39;bounding_box&#39;: {&#39;type&#39;: &#39;Polygon&#39;,
   &#39;coordinates&#39;: [[[-76.831479, 40.22417],
     [-76.811937, 40.22417],
     [-76.811937, 40.242082],
     [-76.831479, 40.242082]]]},
  &#39;attributes&#39;: {}},
 &#39;contributors&#39;: None,
 &#39;is_quote_status&#39;: False,
 &#39;retweet_count&#39;: 0,
 &#39;favorite_count&#39;: 0,
 &#39;favorited&#39;: False,
 &#39;retweeted&#39;: False,
 &#39;lang&#39;: &#39;en&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Building-a-Pull-Loop">Building a Pull Loop<a class="anchor-link" href="#Building-a-Pull-Loop">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We were aware the cap was 900 tweets in 15 minutes.  While we could set up a Twython call to run through some number of indices in our id list, once it hit the 900 limit, it would continue to mow through indices without actually getting anything.  This 900 count includes the significant percentage (~25%) of these old Sandy tweets that have since been deleted and yield no information, they are still counted as tweet calls.  So basically we would move 900 indices through the tweet id list per pull, regardless.</p>
<p>We needed a way to automate looping through this pull process at least a few times so as not to end up with some ridiculous number of csvs, and so we could leave things running.  In order to achieve this, we needed the loop to know where to pick up on each new pull.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Goes through a block of 900 indices from the tweet list, from some start index.</span>
<span class="c1">#Pulls tweet dictionary if tweet exists and adds to lst, otherwise continues to next index.</span>
<span class="c1">#Returns a list with the start index for the next pull, and the lst containing all the tweet dicts.</span>
<span class="c1">#Tqdm allows us to track the progress visually with each pull, as seen below.</span>

<span class="k">def</span> <span class="nf">tweet_pull</span><span class="p">(</span><span class="n">start_index</span><span class="p">):</span>
    <span class="n">tweet</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start_index</span><span class="p">,</span><span class="n">start_index</span><span class="o">+</span><span class="mi">900</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dct</span> <span class="o">=</span> <span class="n">twitter</span><span class="o">.</span><span class="n">show_status</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">sandy_train_ids</span><span class="p">[</span><span class="s1">&#39;tweet_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dct</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">tweet</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">sandy_train_ids</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;tweet_texts&#39;</span><span class="p">,</span> <span class="n">tweet</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">start_index</span><span class="o">+</span><span class="mi">900</span><span class="p">,</span><span class="n">lst</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#While loop for tweet pulling</span>
<span class="c1">#Simply set count = [index you want to start at], and set while count &lt; [index you want to end at] (multiple of 900, ideally)</span>
<span class="c1">#The while loop will run through all the indices in pulls of 900, shifting the start index up 900 each time,</span>
<span class="c1">#and sleeping 15 minutes after each pull to make sure we are never drawing on empty.</span>
<span class="c1">#The pulls are added to a single list of dictionaries that can be converted into a df.</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tweets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">3600</span><span class="p">:</span>
    <span class="n">pull</span> <span class="o">=</span> <span class="n">tweet_pull</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="n">tweets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pull</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">pull</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span> <span class="c1">#15 minute limit</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/900 [00:00&lt;?, ?it/s]C:\Users\eamon\Anaconda3\lib\site-packages\ipykernel_launcher.py:10: FutureWarning: set_value is deprecated and will be removed in a future release. Please use .at[] or .iat[] accessors instead
  # Remove the CWD from sys.path while we load stuff.
100%|██████████| 900/900 [01:19&lt;00:00, 13.37it/s]
100%|██████████| 900/900 [01:18&lt;00:00, 11.41it/s]
100%|██████████| 900/900 [01:25&lt;00:00, 10.57it/s]
100%|██████████| 900/900 [01:29&lt;00:00, 10.06it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[61]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>contributors</th>
      <th>coordinates</th>
      <th>created_at</th>
      <th>entities</th>
      <th>extended_entities</th>
      <th>favorite_count</th>
      <th>favorited</th>
      <th>geo</th>
      <th>id</th>
      <th>id_str</th>
      <th>...</th>
      <th>lang</th>
      <th>place</th>
      <th>possibly_sensitive</th>
      <th>possibly_sensitive_appealable</th>
      <th>retweet_count</th>
      <th>retweeted</th>
      <th>source</th>
      <th>text</th>
      <th>truncated</th>
      <th>user</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>None</td>
      <td>Mon Oct 22 05:00:00 +0000 2012</td>
      <td>{'hashtags': [{'text': 'ilovemaggiesmith', 'in...</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>None</td>
      <td>260244087901413376</td>
      <td>260244087901413376</td>
      <td>...</td>
      <td>en</td>
      <td>{'id': 'c55500e8cd2a1c64', 'url': 'https://api...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;a href="http://twitter.com" rel="nofollow"&gt;Tw...</td>
      <td>"I suppose she has an appropriate costume for ...</td>
      <td>False</td>
      <td>{'id': 24753438, 'id_str': '24753438', 'name':...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>None</td>
      <td>{'type': 'Point', 'coordinates': [-76.8206691,...</td>
      <td>Mon Oct 22 05:00:00 +0000 2012</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>{'type': 'Point', 'coordinates': [40.2371544, ...</td>
      <td>260244088161439744</td>
      <td>260244088161439744</td>
      <td>...</td>
      <td>en</td>
      <td>{'id': 'b8ce2948ffafff5f', 'url': 'https://api...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;a href="http://twitter.com/download/android" ...</td>
      <td>@NOT_savinHOES Not r yu upp</td>
      <td>False</td>
      <td>{'id': 401231570, 'id_str': '401231570', 'name...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>None</td>
      <td>{'type': 'Point', 'coordinates': [-79.20266541...</td>
      <td>Mon Oct 22 05:00:00 +0000 2012</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>{'type': 'Point', 'coordinates': [34.69318931,...</td>
      <td>260244088819945472</td>
      <td>260244088819945472</td>
      <td>...</td>
      <td>en</td>
      <td>{'id': '6057f1e35bcc6c20', 'url': 'https://api...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;a href="http://twitter.com/download/android" ...</td>
      <td>Hit and Run is so sad..</td>
      <td>False</td>
      <td>{'id': 123368790, 'id_str': '123368790', 'name...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>None</td>
      <td>{'type': 'Point', 'coordinates': [-71.04264063...</td>
      <td>Mon Oct 22 05:00:00 +0000 2012</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>{'type': 'Point', 'coordinates': [42.44167162,...</td>
      <td>260244089080004609</td>
      <td>260244089080004609</td>
      <td>...</td>
      <td>en</td>
      <td>{'id': '75f5a403163f6f95', 'url': 'https://api...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;a href="http://twitter.com/download/iphone" r...</td>
      <td>Who's up?</td>
      <td>False</td>
      <td>{'id': 47812293, 'id_str': '47812293', 'name':...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>None</td>
      <td>{'type': 'Point', 'coordinates': [-80.08961896...</td>
      <td>Mon Oct 22 05:00:00 +0000 2012</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>{'type': 'Point', 'coordinates': [42.09464892,...</td>
      <td>260244089985957888</td>
      <td>260244089985957888</td>
      <td>...</td>
      <td>en</td>
      <td>{'id': '29aaa88d9fe74b50', 'url': 'https://api...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;a href="http://twitter.com/download/android" ...</td>
      <td>@augustushazel idk I'm just ugly or annoying o...</td>
      <td>False</td>
      <td>{'id': 274750107, 'id_str': '274750107', 'name...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[62]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2569, 26)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;####.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We coordinated to split up the job of pulling these loops.  We looped through a total of 180000 tweets from the landfall of Sandy.  We used Google Colab and Google Cloud Computing to run our pull loops over long stretches and collected data into a handful of csvs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Combining-All-the-Pulls">Combining All the Pulls<a class="anchor-link" href="#Combining-All-the-Pulls">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[174]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;alexpulls.csv&#39;</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;eamonpulls.csv&#39;</span><span class="p">)</span>
<span class="n">data3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;javipulls.csv&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span><span class="n">data2</span><span class="p">,</span><span class="n">data3</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;sandy_landfall.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Filtering-for-Disaster-Tweets:-Figure-Eight-Model">Filtering for Disaster Tweets: Figure Eight Model<a class="anchor-link" href="#Filtering-for-Disaster-Tweets:-Figure-Eight-Model">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the first issues we ran into in approaching our newly collected dataset is scale.  We knew we would have to manually label the critically relevant tweets, however it was unfeasible to search through over 100k tweets to do this.  So how could we whittle the larger body of tweets down to a selection of at least disaster-related tweets that we could then go through manually.</p>
<p>We discovered a dataset on the website Figure Eight that had also been posted to Kaggle.  It was essentially a dataset of tweets from the time and location of disaster scenarios which had been labeled for disaster-relevant.  So we figured that by training on this dataset first, we could develop a way to whittle our list down to disaster-related tweets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Readme information
Datasets:</p>
<ul>
<li><a href="https://d1p17r2m4rzlbo.cloudfront.net/wp-content/uploads/2016/03/socialmedia-disaster-tweets-DFE.csv">Figure Eight - Disasters on social media dataset</a>
Contributors looked at over 10,000 tweets culled with a variety of searches like “ablaze”, “quarantine”, and “pandemonium”, then noted whether the tweet referred to a disaster event (as opposed to a joke with the word or a movie review or something non-disastrous).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Cleaning Kaggle Data (remove http addresses with regex, lowercase the text)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;kaggle_dataframe_2.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;http:\/\/.*&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;https:\/\/.*&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-Test-Split">Train Test Split<a class="anchor-link" href="#Train-Test-Split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logistic-Regression-GridSearch,-Multiple-Vectorizers">Logistic Regression GridSearch, Multiple Vectorizers<a class="anchor-link" href="#Logistic-Regression-GridSearch,-Multiple-Vectorizers">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We ran Logistic Regression GridSearches with multiple vectorizers (Tdidf, Hashing, Count), and found that CountVectorizer performed the best.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;vect__min_df&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>                            <span class="c1">#In the paragraph after I will explain the parameters chosen</span>
    <span class="s1">&#39;vect__ngram_range&#39;</span><span class="p">:[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span>
    <span class="s1">&#39;vect__stop_words&#39;</span><span class="p">:[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;english&#39;</span><span class="p">],</span>
    <span class="s1">&#39;model__penalty&#39;</span><span class="p">:[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span><span class="s1">&#39;l2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;model__C&#39;</span><span class="p">:[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span> <span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Params: &#39;</span><span class="p">,</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Train: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Test: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Random-Forest-GridSearch,-Multiple-Vectorizers">Random Forest GridSearch, Multiple Vectorizers<a class="anchor-link" href="#Random-Forest-GridSearch,-Multiple-Vectorizers">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">()</span> <span class="p">)</span>
<span class="p">])</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;vect__min_df&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="s1">&#39;vect__stop_words&#39;</span><span class="p">:[</span><span class="kc">None</span> <span class="p">,</span><span class="s1">&#39;english&#39;</span><span class="p">],</span>
    <span class="s1">&#39;vect__ngram_range&#39;</span><span class="p">:[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span>
    <span class="s1">&#39;model__n_estimators&#39;</span><span class="p">:[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="s1">&#39;model__max_depth&#39;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span>
    <span class="s1">&#39;model__min_samples_split&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Params: &#39;</span><span class="p">,</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Train: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Test: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="SVM-GridSearch,-Multiple-Vectorizers">SVM GridSearch, Multiple Vectorizers<a class="anchor-link" href="#SVM-GridSearch,-Multiple-Vectorizers">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;vect__min_df&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="s1">&#39;vect__stop_words&#39;</span><span class="p">:[</span><span class="kc">None</span> <span class="p">,</span><span class="s1">&#39;english&#39;</span><span class="p">],</span>
    <span class="s1">&#39;model__kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span><span class="s1">&#39;poly&#39;</span><span class="p">],</span>
    <span class="s1">&#39;model__C&#39;</span><span class="p">:[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Params: &#39;</span><span class="p">,</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Train: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Test: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Naive-Bayes-GridSearch,-Multiple-Vectorizers">Naive Bayes GridSearch, Multiple Vectorizers<a class="anchor-link" href="#Naive-Bayes-GridSearch,-Multiple-Vectorizers">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;vect__min_df&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="s1">&#39;vect__stop_words&#39;</span><span class="p">:[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;english&#39;</span><span class="p">],</span>
    <span class="s1">&#39;model__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Params: &#39;</span><span class="p">,</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Train: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Test: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="XGBoost-GridSearch,-Multiple-Vectorizers">XGBoost GridSearch, Multiple Vectorizers<a class="anchor-link" href="#XGBoost-GridSearch,-Multiple-Vectorizers">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We ran a number of different boosting classifiers with multiple vectorizers, of which XG Boost performed the best.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;vect__min_df&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="s1">&#39;vect__stop_words&#39;</span><span class="p">:[</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;english&#39;</span><span class="p">],</span>
    <span class="s1">&#39;model__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span>
    <span class="s1">&#39;model__min_samples_split&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="s1">&#39;model__max_depth&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Params: &#39;</span><span class="p">,</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Train: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Test: &#39;</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="VotingClassifier-with-best-LogReg,-XGBoost,-RandomForest-(Final-Model-Choice)">VotingClassifier with best LogReg, XGBoost, RandomForest (Final Model Choice)<a class="anchor-link" href="#VotingClassifier-with-best-LogReg,-XGBoost,-RandomForest-(Final-Model-Choice)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ultimately we went with a VotingClassifier that combined the predictive input of multiple models (LogReg, XGBoost, and Random Forest).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;count_vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;pip1&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)),</span>
                                             <span class="p">(</span><span class="s2">&quot;pip2&quot;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">3</span><span class="p">)),</span>
                                             <span class="c1">#(&quot;pip3&quot;, svm.SVC(kernel=&#39;rbf&#39;,C=10,probability=True)),</span>
                                             <span class="c1">#(&quot;pip4&quot;, MultinomialNB(alpha=1)), </span>

                                             <span class="p">(</span><span class="s2">&quot;pip5&quot;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                                                             <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                             <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">))],</span><span class="n">voting</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">))</span>
         <span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our cross-val score for this model was 0.802, against a baseline accuracy of about 0.58.  This is the best result we saw in this modeling process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-the-VotingClassifier-on-the-Figure-Eight-Dataset">Training the VotingClassifier on the Figure Eight Dataset<a class="anchor-link" href="#Training-the-VotingClassifier-on-the-Figure-Eight-Dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">X_train_features</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_features</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;pip1&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)),</span>
                                  <span class="p">(</span><span class="s2">&quot;pip2&quot;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">3</span><span class="p">)),</span>
                                  <span class="p">(</span><span class="s2">&quot;pip3&quot;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">))]</span>
                                    <span class="p">,</span><span class="n">voting</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_features</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1">#</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Train: &#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_features</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Estimator Score Test: &#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_features</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Confusion-Matrix">Confusion Matrix<a class="anchor-link" href="#Confusion-Matrix">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_features</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_nice_conmat</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">):</span>

    <span class="n">cmat</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Accuracy: {accuracy_score(y_test, preds)}&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cmat</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicted &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Regular Tweets&#39;</span><span class="p">,</span><span class="s1">&#39;Disaster Tweets&#39;</span><span class="p">]],</span>\
            <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Actual &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Regular Tweets&#39;</span><span class="p">,</span><span class="s1">&#39;Disaster Tweets&#39;</span><span class="p">]])</span>

<span class="n">make_nice_conmat</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://i.imgur.com/OdETYZT.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-VotingClassifier-on-Entire-Figure-8-Dataset">Train VotingClassifier on Entire Figure 8 Dataset<a class="anchor-link" href="#Train-VotingClassifier-on-Entire-Figure-8-Dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectorizer2</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">X_features</span> <span class="o">=</span> <span class="n">vectorizer2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>


<span class="n">model2</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;pip1&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)),</span>
                                  <span class="p">(</span><span class="s2">&quot;pip2&quot;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">3</span><span class="p">)),</span>
                                  <span class="p">(</span><span class="s2">&quot;pip3&quot;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">))]</span>
                                    <span class="p">,</span><span class="n">voting</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions2</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_features</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions2</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="WordCloud:-Words-that-Help-Identify-Disaster-Tweets-from-Regular-Tweets">WordCloud: Words that Help Identify Disaster Tweets from Regular Tweets<a class="anchor-link" href="#WordCloud:-Words-that-Help-Identify-Disaster-Tweets-from-Regular-Tweets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#This was based on coefficients from the Logistic Regression model:</span>
<span class="n">wordclouddf</span> <span class="o">=</span> <span class="n">feats</span><span class="o">.</span><span class="n">T</span>
<span class="n">wordclouddf</span> <span class="o">=</span> <span class="n">wordclouddf</span><span class="p">[</span><span class="n">wordclouddf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">wordclouddict</span> <span class="o">=</span> <span class="n">wordclouddf</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="n">wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span><span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate_from_frequencies</span><span class="p">(</span><span class="n">wordclouddict</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://i.imgur.com/mmfEg7T.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Filtering-for-Disaster-Tweets:-Crisis-Words">Filtering for Disaster Tweets: Crisis Words<a class="anchor-link" href="#Filtering-for-Disaster-Tweets:-Crisis-Words">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We were less than completely satisfied with the output of the Kaggle model, and in particular, looking closely at the dataset, felt that some of the labeling was imperfect.  We decided that a keyword list could be useful in further filtering for tweets of disaster relevance.</p>
<p>We located a long list of words identified as disaster-related keywords on CrisisNLP.org. We imported this list and made some additions that we felt were relevant.</p>

</div>
</div>
</div>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[589]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#This is where we added words of our own to the existing CrisisNLP list.  This is the list we will use to filter.  </span>
<span class="c1">#An enterprising user of our model could edit this list themselves very easily:</span>
<span class="n">keys_slist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;affected&#39;</span><span class="p">,</span>
 <span class="s1">&#39;aftermath&#39;</span><span class="p">,</span>
 <span class="s1">&#39;arrest&#39;</span><span class="p">,</span>
 <span class="s1">&#39;attack&#39;</span><span class="p">,</span>
 <span class="s1">&#39;authorities&#39;</span><span class="p">,</span>
 <span class="s1">&#39;blast&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bomber&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bombing&#39;</span><span class="p">,</span>
 <span class="s1">&#39;braces&#39;</span><span class="p">,</span>
 <span class="s1">&#39;buried&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bushfire&#39;</span><span class="p">,</span>
 <span class="s1">&#39;casualties&#39;</span><span class="p">,</span>
 <span class="s1">&#39;cleanup&#39;</span><span class="p">,</span>
 <span class="s1">&#39;collapse&#39;</span><span class="p">,</span>
 <span class="s1">&#39;collapsed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;conditions&#39;</span><span class="p">,</span>
 <span class="s1">&#39;crash&#39;</span><span class="p">,</span>
 <span class="s1">&#39;crisis&#39;</span><span class="p">,</span>
 <span class="s1">&#39;damage&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dangerous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dead&#39;</span><span class="p">,</span>
 <span class="s1">&#39;deadly&#39;</span><span class="p">,</span>
 <span class="s1">&#39;death&#39;</span><span class="p">,</span>
 <span class="s1">&#39;destroyed&#39;</span><span class="p">,</span>
 <span class="s1">&#39;destruction&#39;</span><span class="p">,</span>
 <span class="s1">&#39;devastating&#39;</span><span class="p">,</span>
 <span class="s1">&#39;disaster&#39;</span><span class="p">,</span>
 <span class="s1">&#39;displaced&#39;</span><span class="p">,</span>
 <span class="s1">&#39;donate&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dozens&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dramatic&#39;</span><span class="p">,</span>
 <span class="s1">&#39;drown&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emergency&#39;</span><span class="p">,</span>
 <span class="s1">&#39;enforcement&#39;</span><span class="p">,</span>
 <span class="s1">&#39;evacuated&#39;</span><span class="p">,</span>
 <span class="s1">&#39;evacuees&#39;</span><span class="p">,</span>
 <span class="s1">&#39;events&#39;</span><span class="p">,</span>
 <span class="s1">&#39;explosion&#39;</span><span class="p">,</span>
 <span class="s1">&#39;fatalities&#39;</span><span class="p">,</span>
 <span class="s1">&#39;firefighters&#39;</span><span class="p">,</span>
 <span class="s1">&#39;flood&#39;</span><span class="p">,</span>
 <span class="s1">&#39;flooding&#39;</span><span class="p">,</span>
 <span class="s1">&#39;floodwaters&#39;</span><span class="p">,</span>
 <span class="s1">&#39;footage&#39;</span><span class="p">,</span>
 <span class="s1">&#39;help!&#39;</span><span class="p">,</span>
 <span class="s1">&#39;hurricane&#39;</span><span class="p">,</span>
 <span class="s1">&#39;imminent&#39;</span><span class="p">,</span>
 <span class="s1">&#39;impacted&#39;</span><span class="p">,</span>
 <span class="s1">&#39;injured&#39;</span><span class="p">,</span>
 <span class="s1">&#39;injuries&#39;</span><span class="p">,</span>
 <span class="s1">&#39;inundated&#39;</span><span class="p">,</span>
 <span class="s1">&#39;investigation&#39;</span><span class="p">,</span>
 <span class="s1">&#39;landfall&#39;</span><span class="p">,</span>
 <span class="s1">&#39;levy&#39;</span><span class="p">,</span>
 <span class="s1">&#39;looting&#39;</span><span class="p">,</span>
 <span class="s1">&#39;magnitude&#39;</span><span class="p">,</span>
 <span class="s1">&#39;massive&#39;</span><span class="p">,</span>
 <span class="s1">&#39;military&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nursing&#39;</span><span class="p">,</span>
 <span class="s1">&#39;outage&#39;</span><span class="p">,</span>
 <span class="s1">&#39;prayers&#39;</span><span class="p">,</span>
 <span class="s1">&#39;praying&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ravaged&#39;</span><span class="p">,</span>
 <span class="s1">&#39;rebuild&#39;</span><span class="p">,</span>
 <span class="s1">&#39;rebuilt&#39;</span><span class="p">,</span>
 <span class="s1">&#39;recede&#39;</span><span class="p">,</span>
 <span class="s1">&#39;recover&#39;</span><span class="p">,</span>
 <span class="s1">&#39;redcross&#39;</span><span class="p">,</span>
 <span class="s1">&#39;relief&#39;</span><span class="p">,</span>
 <span class="s1">&#39;rescue&#39;</span><span class="p">,</span>
 <span class="s1">&#39;rescuers&#39;</span><span class="p">,</span>
 <span class="s1">&#39;residents&#39;</span><span class="p">,</span>
 <span class="s1">&#39;responders&#39;</span><span class="p">,</span>
 <span class="s1">&#39;rubble&#39;</span><span class="p">,</span>
 <span class="s1">&#39;saddened&#39;</span><span class="p">,</span>
 <span class="s1">&#39;safety&#39;</span><span class="p">,</span>
 <span class="s1">&#39;seismic&#39;</span><span class="p">,</span>
 <span class="s1">&#39;shelter&#39;</span><span class="p">,</span>
 <span class="s1">&#39;soldier&#39;</span><span class="p">,</span>
 <span class="s1">&#39;storm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;stream&#39;</span><span class="p">,</span>
 <span class="s1">&#39;surviving&#39;</span><span class="p">,</span>
 <span class="s1">&#39;survivor&#39;</span><span class="p">,</span>
 <span class="s1">&#39;terrifying&#39;</span><span class="p">,</span>
 <span class="s1">&#39;terror&#39;</span><span class="p">,</span>
 <span class="s1">&#39;toll&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tornado&#39;</span><span class="p">,</span>
 <span class="s1">&#39;torrential&#39;</span><span class="p">,</span>
 <span class="s1">&#39;toxins&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tragedy&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tragic&#39;</span><span class="p">,</span>
 <span class="s1">&#39;troops&#39;</span><span class="p">,</span>
 <span class="s1">&#39;twister&#39;</span><span class="p">,</span>
 <span class="s1">&#39;unaccounted&#39;</span><span class="p">,</span>
 <span class="s1">&#39;urgent&#39;</span><span class="p">,</span>
 <span class="s1">&#39;victims&#39;</span><span class="p">,</span>
 <span class="s1">&#39;volunteers&#39;</span><span class="p">,</span>
 <span class="s1">&#39;warning&#39;</span><span class="p">,</span>
 <span class="s1">&#39;wounded&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Apply-Filters-to-Generate-List-of-Disaster-Tweets">Apply Filters to Generate List of Disaster Tweets<a class="anchor-link" href="#Apply-Filters-to-Generate-List-of-Disaster-Tweets">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Apply-Figure-8-Model-to-Sandy-Landfall-Tweets">Apply Figure 8 Model to Sandy Landfall Tweets<a class="anchor-link" href="#Apply-Figure-8-Model-to-Sandy-Landfall-Tweets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sandy_landfall.csv&#39;</span><span class="p">)</span>

<span class="c1">#Cleaning</span>
<span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[^\w\s#@/:%.,_-]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;http:\/\/.*&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;https:\/\/.*&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>

<span class="c1">#Apply VotingClassifier model to data</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;kaggle_model_2.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Apply-Keyword-Filter-to-Sandy-Landfall-Tweets">Apply Keyword Filter to Sandy Landfall Tweets<a class="anchor-link" href="#Apply-Keyword-Filter-to-Sandy-Landfall-Tweets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Isolates tweets that have not been predicted as disaster tweets by the Figure 8 model</span>
<span class="n">non_predicted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">#Recall that keys_slist is the list of crisis keywords defined explicitly above</span>
<span class="c1">#This maps through the tweets not labeled as disaster and labels them as disaster if they include keywords</span>
<span class="n">non_predicted</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">non_predicted</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">keys_slist</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#Combines keyword flags and Figure 8 model flags to produce the set of all disaster tweets</span>
<span class="n">keywords</span> <span class="o">=</span><span class="n">non_predicted</span><span class="p">[</span><span class="n">non_predicted</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">disaster_tweets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">keywords</span><span class="p">,</span><span class="n">predicted</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Produces set of all regular tweets</span>
<span class="n">regular_tweets</span> <span class="o">=</span> <span class="n">non_predicted</span><span class="p">[</span><span class="n">non_predicted</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_tweets</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;disaster_tweets.csv&#39;</span><span class="p">)</span>
<span class="n">regular_tweets</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;regular_tweets.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Identifying-Critical-Tweets-Among-Disaster-Tweets">Identifying Critical Tweets Among Disaster Tweets<a class="anchor-link" href="#Identifying-Critical-Tweets-Among-Disaster-Tweets">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Manually-Labeling-Disaster-Related-Tweets">Manually Labeling Disaster Related Tweets<a class="anchor-link" href="#Manually-Labeling-Disaster-Related-Tweets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We combed through the approximately 9000 tweets identified by the Figure Eight Model and Keyword Filtering as disaster tweets. We manually identified about 900 tweets that we felt met criteria for "critical" - i.e.; novel information that could be immediately relevant to emergency responders.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[773]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Reload disaster tweets with labels now included</span>
<span class="n">disaster_labeled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./manual_tags_final.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[774]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[774]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>created_at</th>
      <th>coordinates</th>
      <th>geo</th>
      <th>place</th>
      <th>user</th>
      <th>entities</th>
      <th>in_reply_to_user_id</th>
      <th>lang</th>
      <th>predicted</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>263097193563566080</td>
      <td>rt @passantino: wow: floodwaters inundate grou...</td>
      <td>Tue Oct 30 01:57:13 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-80.7245571,...</td>
      <td>{'type': 'Point', 'coordinates': [41.025018, -...</td>
      <td>{'id': 'de599025180e2ee7', 'url': 'https://api...</td>
      <td>{'id': 373792493, 'id_str': '373792493', 'name...</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>en</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>263097199213285377</td>
      <td>some folks maybe feelin lonely bein in a storm...</td>
      <td>Tue Oct 30 01:57:15 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-76.8325555,...</td>
      <td>{'type': 'Point', 'coordinates': [38.89184242,...</td>
      <td>{'id': '19f2fcdf0d209467', 'url': 'https://api...</td>
      <td>{'id': 250905822, 'id_str': '250905822', 'name...</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>en</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>263097201469845504</td>
      <td>#itjustgotreal ... #iphonealerts  @ #hurricane...</td>
      <td>Tue Oct 30 01:57:15 +0000 2012</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'id': 'b6ea2e341ba4356f', 'url': 'https://api...</td>
      <td>{'id': 112052977, 'id_str': '112052977', 'name...</td>
      <td>{'hashtags': [{'text': 'itJustGotReal', 'indic...</td>
      <td>NaN</td>
      <td>und</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>263097206125518849</td>
      <td>@ahurricanesandy hey #sandy get your ass down ...</td>
      <td>Tue Oct 30 01:57:16 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-79.99661002...</td>
      <td>{'type': 'Point', 'coordinates': [35.97201904,...</td>
      <td>{'id': 'aef8c3da277ca498', 'url': 'https://api...</td>
      <td>{'id': 266676966, 'id_str': '266676966', 'name...</td>
      <td>{'hashtags': [{'text': 'Sandy', 'indices': [21...</td>
      <td>364217289.0</td>
      <td>en</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>263097208923099136</td>
      <td>everytime the wind picks up it sounds like som...</td>
      <td>Tue Oct 30 01:57:17 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-80.4487703,...</td>
      <td>{'type': 'Point', 'coordinates': [37.213948, -...</td>
      <td>{'id': '820684853e0f1eb6', 'url': 'https://api...</td>
      <td>{'id': 479075523, 'id_str': '479075523', 'name...</td>
      <td>{'hashtags': [{'text': 'hurricanessuck', 'indi...</td>
      <td>NaN</td>
      <td>en</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>tag</strong> column indicates whether the tweet was manually tagged as "critical".  This is based on our first tagging run, in which we cast a relatively wide net.  The <strong>predicted</strong> column indicates whether the tweet is disaster related (all of these were, of course), in case we want to concatenate with our regular tweets data (predicted = 0) later on.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above is also a good look at what our tweet data dictionaries contain.  Not everything is immediately relevant to the project here, but we left in anything that might be used predictively later on.  Obviously, we have the specific ID that we can use to look up the tweet online, or use as an index.  We also have:</p>
<ul>
<li>the text of the tweet</li>
<li>the timestamp</li>
<li>the geo-coordinate information</li>
<li>a place dictionary that contains information about the area including the city/neighborhood of origin</li>
<li>a dictionary of information about the user sending the tweet</li>
<li>a dictionary that grabs any hashtags the tweet contains</li>
<li>a column that allows us to tell if the tweet was a reply or not</li>
<li>the language of the tweet</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Labeled-Disaster-Tweets---Data-Cleaning">Labeled Disaster Tweets - Data Cleaning<a class="anchor-link" href="#Labeled-Disaster-Tweets---Data-Cleaning">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[776]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Check if we missed or deleted any cells while tagging manually</span>
<span class="n">disaster_labeled</span><span class="p">[</span><span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[776]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>created_at</th>
      <th>coordinates</th>
      <th>geo</th>
      <th>place</th>
      <th>user</th>
      <th>entities</th>
      <th>in_reply_to_user_id</th>
      <th>lang</th>
      <th>predicted</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30</th>
      <td>263097391169826817</td>
      <td>@rwzombie fuck #hurricanesandy keep voting</td>
      <td>Tue Oct 30 01:58:00 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-74.95308309...</td>
      <td>{'type': 'Point', 'coordinates': [40.04676075,...</td>
      <td>{'id': '31fbce652077706d', 'url': 'https://api...</td>
      <td>{'id': 25303398, 'id_str': '25303398', 'name':...</td>
      <td>{'hashtags': [{'text': 'hurricanesandy', 'indi...</td>
      <td>43469093.0</td>
      <td>en</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[777]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[777]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0    8694
1.0     836
Name: tag, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[780]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#english language only</span>
<span class="n">disaster_labeled</span> <span class="o">=</span> <span class="n">disaster_labeled</span><span class="p">[</span><span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>
<span class="c1">#create readable datetime column and sort by datetime</span>
<span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
<span class="n">disaster_labeled</span> <span class="o">=</span> <span class="n">disaster_labeled</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Selects columns of interest</span>
<span class="n">disaster_labeled</span> <span class="o">=</span> <span class="n">disaster_labeled</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">,</span><span class="s1">&#39;tag&#39;</span><span class="p">]]</span>

<span class="c1">#remove retweets (begins with rt)</span>
<span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;rt&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">disaster_labeled</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#remove retweets (contains rt elsewhere)</span>
<span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="s1">&#39;rt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">disaster_labeled</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[865]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[865]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>datetime</th>
      <th>geo</th>
      <th>predicted</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.630677e+17</td>
      <td>@godseyg i was arrested about 36 hours later. ...</td>
      <td>2012-10-30 00:00:02</td>
      <td>{'type': 'Point', 'coordinates': [39.12081393,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.630677e+17</td>
      <td>wish i was wiff my love during this disaster #...</td>
      <td>2012-10-30 00:00:04</td>
      <td>{'type': 'Point', 'coordinates': [41.28866479,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.630677e+17</td>
      <td>im a hurricane vet.. so #hurricanesandy isnt a...</td>
      <td>2012-10-30 00:00:04</td>
      <td>{'type': 'Point', 'coordinates': [39.12088316,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.630677e+17</td>
      <td>the scorpions - rock you like a hurricane #201...</td>
      <td>2012-10-30 00:00:04</td>
      <td>{'type': 'Point', 'coordinates': [42.60095122,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.630677e+17</td>
      <td>lights out @ frankenstorm apocalypse - hurrica...</td>
      <td>2012-10-30 00:00:06</td>
      <td>{'type': 'Point', 'coordinates': [40.79093941,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[798]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./disaster_labeled.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">disaster_labeled</span><span class="p">[</span><span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./critical.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">disaster_labeled</span><span class="p">[</span><span class="n">disaster_labeled</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./disaster_nonrel.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Weighting-and-Bootstrapping">Weighting and Bootstrapping<a class="anchor-link" href="#Weighting-and-Bootstrapping">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After manually tagging, we had about a 9:1 ratio of disaster non critical to disaster critical tweets, so baseline accuracy of about 90%.  In order to resolve this it was necessary to oversample the tweets we had labeled critical (bootstrapping).  We expanded the 900ish critical tweets to 9000, balancing the classes evenly.</p>
<p>While manually tagging, we had often felt that some of the tweets we labeled critical were borderline, while others were immediate and dire, and highly useful potentially.  We felt this should be reflected in our bootstrapping by using weighted probabilities in our oversampling.  We thus went through the 900 critical tweets and weighted them 1, 3, 5, or 10 based on their degree of relevance to emergency personnel who might be scanning twitter for information.  We then normalized these to percentages of 1 to create probabilities for use in bootstrapping.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weighted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;weighted_critical.csv&#39;</span><span class="p">)</span>

<span class="c1">#Converts manually assigned weights to bootstrap weighted probabilities</span>
<span class="n">weighted</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">weighted</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="n">weighted</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">boot</span> <span class="o">=</span> <span class="n">weighted</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">9000</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weighted</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">boot</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">nonrel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;disaster_nonrel.csv&#39;</span><span class="p">)</span>
<span class="n">nonrel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">disaster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">nonrel</span><span class="p">,</span> <span class="n">boot</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-Model-to-Predict-Actual-Relevance-from-within-Disaster-Related-Tweets">Training Model to Predict Actual Relevance from within Disaster Related Tweets<a class="anchor-link" href="#Training-Model-to-Predict-Actual-Relevance-from-within-Disaster-Related-Tweets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We tried our hand with a few different things, but ended up settling on a similarly trained VotingClassifier to our earlier Figure 8 Model, with combination of trained LogReg, XGBoost and Random Forest Classifiers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">disaster</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">disaster</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span>

<span class="n">disaster_model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;count_vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span>
        <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;pip1&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)),</span>
                                  <span class="p">(</span><span class="s2">&quot;pip2&quot;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">3</span><span class="p">)),</span>
                                  <span class="p">(</span><span class="s2">&quot;pip3&quot;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">))]</span>
                                    <span class="p">,</span><span class="n">voting</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">))</span>
         <span class="p">])</span>
<span class="n">disaster_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We observed cross-validation scores in the mid to high 90s with this training process, however this was obviously the result of highly weighted bootstrapped replacement tweets appearing in the test split as well as in the train split.  The only way to really assess performance is to run the model on test data and see how its predictions perform.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="WordCloud:-Words-that-Help-Identify-Critical-Tweets-Among-Disaster-Tweets">WordCloud: Words that Help Identify Critical Tweets Among Disaster Tweets<a class="anchor-link" href="#WordCloud:-Words-that-Help-Identify-Critical-Tweets-Among-Disaster-Tweets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://i.imgur.com/FL6iEue.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Testing-2-Phase-Model-{1.-Disaster-Filter,-2.-Predict-Critical}-on-New-Data">Testing 2-Phase Model {1. Disaster Filter, 2. Predict Critical} on New Data<a class="anchor-link" href="#Testing-2-Phase-Model-{1.-Disaster-Filter,-2.-Predict-Critical}-on-New-Data">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Building-ID-List-for-Sandy-Test-Set">Building ID List for Sandy Test Set<a class="anchor-link" href="#Building-ID-List-for-Sandy-Test-Set">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For our test set, we wanted to sample from a wider section of the hurricane's course.  We aimed for about 40000 tweets for the test set.  We decided to randomly select 40000 tweets from the 2 million or so post-landfall time window tweets, so, starting at the end of the window of our training set (10PM on 10/29) through the last timestamp in the ID List (11/2).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[535]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#creates our test set id list</span>
<span class="c1">#Random selection of tweets over the rest of the hurricane, so we can show geographic progression in mapping as well</span>
<span class="c1">#40,500 was chosen as n because it is a convenient multiple of 2700 (900*3) for the tweet pulls</span>

<span class="n">sandy_random</span> <span class="o">=</span> <span class="n">dftime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4608435</span><span class="p">:</span><span class="mi">6000000</span><span class="p">,:]</span>
<span class="n">sandy_random</span> <span class="o">=</span> <span class="n">sandy_random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">40500</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">37</span><span class="p">)</span>
<span class="n">sandy_random</span> <span class="o">=</span> <span class="n">sandy_random</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span>
<span class="n">sandy_random</span> <span class="o">=</span> <span class="n">sandy_random</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[551]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_random</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;sandy_random.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As with the main set, we ran tweet pulls in tandem and combined the resulting csvs to complete the test set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cleaning-the-Test-Data">Cleaning the Test Data<a class="anchor-link" href="#Cleaning-the-Test-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[758]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./alexrandom1.csv&#39;</span><span class="p">)</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./alexrandom2.csv&#39;</span><span class="p">)</span>
<span class="n">test3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./eamonrandom1.csv&#39;</span><span class="p">)</span>
<span class="n">test4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./eamonrandom2.csv&#39;</span><span class="p">)</span>
<span class="n">test5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./eamonrandom3.csv&#39;</span><span class="p">)</span>
<span class="n">test6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./javirandom1.csv&#39;</span><span class="p">)</span>
<span class="n">test7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./javirandom2.csv&#39;</span><span class="p">)</span>
<span class="n">test8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./javirandom3.csv&#39;</span><span class="p">)</span>
<span class="n">test9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./javirandom4.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[759]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test1</span><span class="p">,</span><span class="n">test2</span><span class="p">,</span><span class="n">test3</span><span class="p">,</span><span class="n">test4</span><span class="p">,</span><span class="n">test5</span><span class="p">,</span><span class="n">test6</span><span class="p">,</span><span class="n">test7</span><span class="p">,</span><span class="n">test8</span><span class="p">,</span><span class="n">test9</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[760]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testset</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[761]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testset</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>

<span class="c1">#create readable datetime column and sort by datetime</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
<span class="n">testset</span> <span class="o">=</span> <span class="n">testset</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#english language only</span>
<span class="n">testset</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>

<span class="c1">#create readable datetime column and sort by datetime</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
<span class="n">testset</span> <span class="o">=</span> <span class="n">testset</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Selects columns of interest</span>
<span class="n">testset</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">]]</span>

<span class="c1">#remove retweets (begins with rt)</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;rt&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">testset</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#remove retweets (contains rt elsewhere)</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="s1">&#39;rt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">testset</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[763]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[^\w\s#@/:%.,_-]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">)</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;http:\/\/.*&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;https:\/\/.*&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">testset</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;testset.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Running-the-Filter/Models-on-the-Test-Data">Running the Filter/Models on the Test Data<a class="anchor-link" href="#Running-the-Filter/Models-on-the-Test-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Run Figure 8 model and separate into non-predicted and disaster tweets.</span>
<span class="n">testset</span><span class="p">[</span><span class="s1">&#39;is_disaster&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">kaggle_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">regular_test</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;is_disaster&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">disaster_test</span> <span class="o">=</span> <span class="n">testset</span><span class="p">[</span><span class="n">testset</span><span class="p">[</span><span class="s1">&#39;is_disaster&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">#Apply keyword filter to non-predicted to identify additional disaster tweets, and combine to collect all disaster tweets</span>
<span class="n">regular_test</span><span class="p">[</span><span class="s1">&#39;is_disaster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regular_test</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">keys_slist</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">keywords</span> <span class="o">=</span><span class="n">regular_test</span><span class="p">[</span><span class="n">regular_test</span><span class="p">[</span><span class="s1">&#39;is_disaster&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">disaster_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">keywords</span><span class="p">,</span><span class="n">disaster_test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Run Critical Tweet Identifier model on disaster tweets</span>
<span class="n">disaster_test</span><span class="p">[</span><span class="s1">&#39;critical&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">disaster_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">disaster_test</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>

<span class="c1">#Review each class</span>
<span class="n">critical</span> <span class="o">=</span> <span class="n">disaster_test</span><span class="p">[</span><span class="n">disaster_test</span><span class="p">[</span><span class="s1">&#39;critical&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">disaster</span> <span class="n">nonrel</span> <span class="o">=</span> <span class="n">disaster_test</span><span class="p">[</span><span class="n">disaster_test</span><span class="p">[</span><span class="s1">&#39;critical&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">regular</span> <span class="o">=</span> <span class="n">regular_test</span><span class="p">[</span><span class="n">regular_test</span><span class="p">[</span><span class="s1">&#39;is_disaster&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show results (I.E. disaster non-relevant and disaster critical results) side by side....</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Remark on how the results were actually quite satisfying</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-Combined-Landfall-Dataset-with-Class-Labeling">Create Combined Landfall Dataset with Class Labeling<a class="anchor-link" href="#Create-Combined-Landfall-Dataset-with-Class-Labeling">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One alternative that we considered, with our manual tags done, would simply be to add regular tweets back in and train on the entire sea of tweets, regular and disaster related, trying to pick out only the actually relevant tweets from everything.  We felt this would be less powerful than using a second phase to specifically discriminate actually relevant tweets from non-relevant disaster-related tweets.  But we may want to try this at some point.  It does have the advantage of condensing the predictive process into a single step.</p>
<p>Even without this application though, it's necessary for us to build out a cleaned, combined dataset to be able to visualize a geo-map where we can easily represent disaster and critical tweets amid the sea of all tweets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[813]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#This is the set of Sandy Landfall Tweets (our main pull) that was not labeled </span>
<span class="c1">#as disaster tweets by either the Figure 8 Model or the Keyword Filtering</span>
<span class="n">regular_tweets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./regular_final.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[814]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regular_tweets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[814]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>created_at</th>
      <th>coordinates</th>
      <th>geo</th>
      <th>place</th>
      <th>user</th>
      <th>entities</th>
      <th>in_reply_to_user_id</th>
      <th>lang</th>
      <th>predicted</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>263097187775434752</td>
      <td>if anybody needs a 2nd shift job and can pass ...</td>
      <td>Tue Oct 30 01:57:12 +0000 2012</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'id': 146665477, 'id_str': '146665477', 'name...</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>en</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>263097188446523393</td>
      <td>of course when the voice is on, my tv decides ...</td>
      <td>Tue Oct 30 01:57:12 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-81.33815822...</td>
      <td>{'type': 'Point', 'coordinates': [41.15005871,...</td>
      <td>{'id': '45a0ea3329c38f9f', 'url': 'https://api...</td>
      <td>{'id': 65144874, 'id_str': '65144874', 'name':...</td>
      <td>{'hashtags': [{'text': 'ThanksSandy', 'indices...</td>
      <td>NaN</td>
      <td>en</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>263097191260901378</td>
      <td>@ken_fedor oh hell yeah. we need too</td>
      <td>Tue Oct 30 01:57:13 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-74.10466037...</td>
      <td>{'type': 'Point', 'coordinates': [40.87194808,...</td>
      <td>{'id': '86fc60f26e1639cc', 'url': 'https://api...</td>
      <td>{'id': 331299957, 'id_str': '331299957', 'name...</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>en</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>263097191881646080</td>
      <td>ok...  enough sandy, time to go away.  no real...</td>
      <td>Tue Oct 30 01:57:13 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-77.092894, ...</td>
      <td>{'type': 'Point', 'coordinates': [38.978183, -...</td>
      <td>{'id': '864ff125241f172f', 'url': 'https://api...</td>
      <td>{'id': 302586627, 'id_str': '302586627', 'name...</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>en</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>263097193530023936</td>
      <td>niggas not loyal</td>
      <td>Tue Oct 30 01:57:13 +0000 2012</td>
      <td>{'type': 'Point', 'coordinates': [-81.6315227,...</td>
      <td>{'type': 'Point', 'coordinates': [41.5384851, ...</td>
      <td>{'id': '0eb9676d24b211f1', 'url': 'https://api...</td>
      <td>{'id': 390423015, 'id_str': '390423015', 'name...</td>
      <td>{'hashtags': [], 'symbols': [], 'user_mentions...</td>
      <td>NaN</td>
      <td>en</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Regular-Tweets---Data-Cleaning">Regular Tweets - Data Cleaning<a class="anchor-link" href="#Regular-Tweets---Data-Cleaning">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[815]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#creates target column for regular tweets, all of which should be 0</span>
<span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">regular_tweets</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[816]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regular_tweets</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[816]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(105804, 12)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[817]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regular_tweets</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[817]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>id                         0
text                       4
created_at                 2
coordinates            10378
geo                    10378
place                   3170
user                      24
entities                   2
in_reply_to_user_id    69816
lang                      27
predicted                  0
tag                        0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[818]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regular_tweets</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[819]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#english language only</span>
<span class="n">regular_tweets</span> <span class="o">=</span> <span class="n">regular_tweets</span><span class="p">[</span><span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>

<span class="c1">#create readable datetime column and sort by datetime</span>
<span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
<span class="n">regular_tweets</span> <span class="o">=</span> <span class="n">regular_tweets</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Selects columns of interest</span>
<span class="n">regular_tweets</span> <span class="o">=</span> <span class="n">regular_tweets</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">,</span><span class="s1">&#39;tag&#39;</span><span class="p">]]</span>

<span class="c1">#remove retweets (begins with rt)</span>
<span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;rt&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">regular_tweets</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#remove retweets (contains rt elsewhere)</span>
<span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="s1">&#39;rt&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">regular_tweets</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regular_tweets</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Combine-Regular-and-Disaster">Combine Regular and Disaster<a class="anchor-link" href="#Combine-Regular-and-Disaster">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[820]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;disaster_labeled.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[821]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">disaster_labeled</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[821]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>datetime</th>
      <th>geo</th>
      <th>predicted</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.630677e+17</td>
      <td>@godseyg i was arrested about 36 hours later. ...</td>
      <td>2012-10-30 00:00:02</td>
      <td>{'type': 'Point', 'coordinates': [39.12081393,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.630677e+17</td>
      <td>wish i was wiff my love during this disaster #...</td>
      <td>2012-10-30 00:00:04</td>
      <td>{'type': 'Point', 'coordinates': [41.28866479,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.630677e+17</td>
      <td>im a hurricane vet.. so #hurricanesandy isnt a...</td>
      <td>2012-10-30 00:00:04</td>
      <td>{'type': 'Point', 'coordinates': [39.12088316,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.630677e+17</td>
      <td>the scorpions - rock you like a hurricane #201...</td>
      <td>2012-10-30 00:00:04</td>
      <td>{'type': 'Point', 'coordinates': [42.60095122,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.630677e+17</td>
      <td>lights out @ frankenstorm apocalypse - hurrica...</td>
      <td>2012-10-30 00:00:06</td>
      <td>{'type': 'Point', 'coordinates': [40.79093941,...</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[822]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Combines disaster-related and regular tweets into a cleaned dataset containing all three classes</span>
<span class="c1">#(Regular, Disaster Non-Critical, and Disaster Critical)</span>
<span class="c1">#The convenience of this dataset is it can easily be manipulated to have a class column with all three types labeled.</span>
<span class="c1">#This will be useful for geo-mapping visualizations.</span>
<span class="n">sandy_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">disaster_labeled</span><span class="p">,</span><span class="n">regular_tweets</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sandy_combined</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sandy_combined</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span>
<span class="n">sandy_combined</span> <span class="o">=</span> <span class="n">sandy_combined</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span>
<span class="n">sandy_combined</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_combined</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[830]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_combined</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./sandy_combined.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Geomapping-Landfall-Data-in-Tableau">Geomapping Landfall Data in Tableau<a class="anchor-link" href="#Geomapping-Landfall-Data-in-Tableau">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the first geomap, we want to map the full body of tweets (regular, disaster, and critical) from the main pull, ie all geotagged tweets from the northeastern seaboard from the time of Sandy landfall in NJ/NY to about 15 hours later.  Some additional processing needs to be done.  Also, not all tweets in our pull have precise coordinates, although most do.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Geomap-Preprocessing">Geomap Preprocessing<a class="anchor-link" href="#Geomap-Preprocessing">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[831]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_geomap</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sandy_combined.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[833]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Remove all rows that don&#39;t have coordinates</span>
<span class="n">sandy_geomap</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>

<span class="c1">#Splits geo column into latitude and longitude columns</span>
<span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1">#Condenses to relevant information for geomapping</span>
<span class="n">sandy_geomap</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span><span class="s1">&#39;predicted&#39;</span><span class="p">,</span><span class="s1">&#39;tag&#39;</span><span class="p">]]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[836]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_geomap</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 94043 entries, 0 to 104272
Data columns (total 7 columns):
id           94043 non-null int64
text         94043 non-null object
latitude     94043 non-null float64
longitude    94043 non-null float64
datetime     94043 non-null object
predicted    94043 non-null float64
tag          94043 non-null float64
dtypes: float64(4), int64(1), object(2)
memory usage: 5.7+ MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[847]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[848]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_geomap</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[848]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0    86060
1.0     7297
2.0      686
Name: class, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[849]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_geomap</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;sandy_geomap.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[850]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">sandy_geomap</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[850]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>94043</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[867]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sandy_geomap</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[867]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>datetime</th>
      <th>predicted</th>
      <th>tag</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>263067699821821952</td>
      <td>i should probably start doing my hw</td>
      <td>43.104663</td>
      <td>-75.127981</td>
      <td>2012-10-30 00:00:01</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>263067700270596096</td>
      <td>good thing i practiced my i totally understand...</td>
      <td>39.166361</td>
      <td>-84.606048</td>
      <td>2012-10-30 00:00:01</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>263067699133947904</td>
      <td>@day_hammonds you already know</td>
      <td>34.997820</td>
      <td>-80.090215</td>
      <td>2012-10-30 00:00:01</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>263067696235692032</td>
      <td>@tiffany_niccole im sitting at this gate a6 to...</td>
      <td>39.998155</td>
      <td>-82.884330</td>
      <td>2012-10-30 00:00:01</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>263067699213660160</td>
      <td>girls who go commandogtgt</td>
      <td>39.923918</td>
      <td>-75.173551</td>
      <td>2012-10-30 00:00:01</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mapping-Disaster-Related-and-Critical-Tweets---Hurricane-Sandy-Landfall---Northeast-Region-(Tableau)">Mapping Disaster-Related and Critical Tweets - Hurricane Sandy Landfall - Northeast Region (Tableau)<a class="anchor-link" href="#Mapping-Disaster-Related-and-Critical-Tweets---Hurricane-Sandy-Landfall---Northeast-Region-(Tableau)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">


<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="prompt"></div>

<div class="output_html rendered_html output_subarea ">

<div class='tableauPlaceholder' id='viz1547848544212' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ma&#47;MappingDisasterRelatedandDisasterUrgentTweets-HurricaneSandyLandfall&#47;Sheet1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='MappingDisasterRelatedandDisasterUrgentTweets-HurricaneSandyLandfall&#47;Sheet1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ma&#47;MappingDisasterRelatedandDisasterUrgentTweets-HurricaneSandyLandfall&#47;Sheet1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1547848544212');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Real-Time-Mapping-Disaster-Critical-Tweets-in-the-NYC-Area-during-Hurricane-Sandy-Landfall-(Tableau)">Real-Time Mapping Disaster Critical Tweets in the NYC Area during Hurricane Sandy Landfall (Tableau)<a class="anchor-link" href="#Real-Time-Mapping-Disaster-Critical-Tweets-in-the-NYC-Area-during-Hurricane-Sandy-Landfall-(Tableau)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

<div class='tableauPlaceholder' id='viz1547848675634' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYCSandyTweetMap&#47;Sheet1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='NYCSandyTweetMap&#47;Sheet1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NY&#47;NYCSandyTweetMap&#47;Sheet1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1547848675634');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Live-Streaming-Disaster-Tweets-via-Twython">Live Streaming Disaster Tweets via Twython<a class="anchor-link" href="#Live-Streaming-Disaster-Tweets-via-Twython">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We wanted to return at the end to the root purpose of the project and see what we could do with applying our model to real-time tweets. The primary difficulty here was just obtaining the tweets, but we were able to develop a method using Twython.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#This set of code uses Twython to stream tweets with disaster keywords in real-time.  </span>
<span class="c1">#It also compiles these incoming tweets into dataframes of n=100, for potential analysis with our model.</span>

<span class="kn">from</span> <span class="nn">twython</span> <span class="k">import</span> <span class="n">TwythonStreamer</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">class</span> <span class="nc">MyStreamer</span><span class="p">(</span><span class="n">TwythonStreamer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="p">[],</span> <span class="n">texts</span><span class="o">=</span><span class="p">[],</span><span class="n">geos</span><span class="o">=</span><span class="p">[],</span><span class="n">created_ats</span><span class="o">=</span><span class="p">[],</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">]),</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span> <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
        <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
        <span class="n">geos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">])</span>
        <span class="n">created_ats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ids</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">texts</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geos</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">created_ats</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./Live_tweets/Live Tweets &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CSV SAVED&#39;</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">,</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>

<span class="n">stream</span> <span class="o">=</span> <span class="n">MyStreamer</span><span class="p">(</span><span class="n">app_key</span><span class="o">=</span><span class="s1">&#39;INSERT KEY HERE&#39;</span><span class="p">,</span>
                    <span class="n">app_secret</span><span class="o">=</span><span class="s1">&#39;INSERT KEY HERE&#39;</span><span class="p">,</span>
                    <span class="n">oauth_token</span><span class="o">=</span><span class="s1">&#39;INSERT KEY HERE&#39;</span><span class="p">,</span>
                    <span class="n">oauth_token_secret</span><span class="o">=</span><span class="s1">&#39;INSERT KEY HERE&#39;</span><span class="p">)</span>


<span class="n">stream</span><span class="o">.</span><span class="n">statuses</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">track</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fire&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusions">Conclusions<a class="anchor-link" href="#Conclusions">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our primary takeaways in this project thus far are as follows:</p>
<p>Despite initial setbacks, we were able to arrive at a satisfying and effective two-phase process for identifying critical disaster tweets out of the sea of all incoming tweets on social media. We were pleased with how well we were able to isolate potentially relevant tweets from a sea of test data. We also successfully visualized what an interface for receiving geotagged tweets in real-time might look like, although we expect a more integrated and multi-functional mapping software than Tableau might be necessary for real-world implementation. Finally, we were able to demonstrate proof-of-concept on live-streaming capture of tweets.</p>
<p>Given unrestricted access to the data available via Twitter, let alone Facebook, Snapchat, Instagram (all of which FEMA or a similar organization would likely have in the hypothetical scenario where they would implement this process), I feel we have demonstrated that it would be absolutely possible to build out a very useful and accurate geo-feed of emergency response information in the area of an ongoing disaster.</p>
<p>All of this bodes well for future expansion of the project. Other directions we might go with more time include attempting to involve another social media platform, or locate a database of tweets from a disaster scenario other than a hurricane to try and diversify our filtering process. We also would like to try and improve predictive accuracy by use of Words2Vec, which is well equipped to locate similar types of tweets (e.g. critical tweets) without explicit labeling.</p>

</div>
</div>
</div>
    </div>
  </div>










<!-- PROJECT NOTEBOOK BOTTOM -->
</div>

</div>
</div>


<!--<div id="map"></div>-->
</div>
</div>

<!-- jQuery -->

<script src="../js/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="../js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="../js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="../js/jquery.waypoints.min.js"></script>
<!-- Flexslider -->
<script src="../js/jquery.flexslider-min.js"></script>
<!-- Sticky Kit -->
<script src="../js/sticky-kit.min.js"></script>
<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCefOgb1ZWqYtj7raVSmN4PL2WkTrc-KyA&sensor=false"></script>
<script src="../js/google_map.js"></script>


<!-- MAIN JS -->
<script src="../js/main.js"></script>

</body>
</html>
